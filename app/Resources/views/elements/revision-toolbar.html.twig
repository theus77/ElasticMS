<div class="btn-group">
	{% include 'elements/get-button.html.twig' with { 
			'url': path('data.revisions', {
				'type': instance.contentType.name,
				'ouuid': instance.ouuid,
				'revisionId': revisionId
			}), 
			'label': 'View', 
			'icon': 'eye' }%}
	{% if draft %} 	
		{% if instance.contentType.fieldType.fieldsRoles|one_granted %}
			{% include 'elements/get-button.html.twig' with { 
				'url': path('revision.edit', {'revisionId': revisionId}), 
				'label': 'Edit draft', 
				'icon': 'pencil' }%}
			{% include 'elements/post-button.html.twig' with {
				'url': path('revision.discard', {'revisionId': revisionId}),
				'message': 'Discard this draft ?',
				'label': 'Discard',
				'icon': 'trash'
			}%}
		{% endif %}
	{% else %}
		{# TODO: better way to determine if there is a environement to publish this revision in ? #}
		{# twig function ?#}
		{% set hasEnv = false %}
		{% for env in availableEnv %}
			{% if env not in environments %}
	   			{% set hasEnv = true %}
		   	{% endif %}
	   	{% endfor %}
	   	
		
		{% for env in environments %}
				{% include 'elements/object-views-button.html.twig' with { 
					'object':  object,
					'contentType': instance.contentType,
					'environment': env
				}%}
   		{% endfor %}


	   	{% if instance.contentType.fieldType.fieldsRoles|one_granted %}
			{% if draft %} 
				{% include 'elements/get-button.html.twig' with { 
					'url': path('revision.edit', {'revisionId': revisionId}), 
					'label': 'Edit draft', 
					'icon': 'pencil' }%}
			{% elseif current  %} 
				{% include 'elements/post-button.html.twig' with { 
					'url': path('revision.new-draft', {'ouuid': revision.ouuid, 'type':revision.contentType.name }), 
					'label': 'New draft', 
					'icon': 'pencil' }%}
			{% else %} 
				{% if instance.contentType.fieldType.fieldsRoles|one_granted(true) %}
					{% include 'elements/get-button.html.twig' with { 
						'url': path('revision.edit', {'revisionId': revisionId}), 
						'label': 'Edit revision', 
						'icon': 'pencil' }%}
				{% endif %}
				{% include 'elements/post-button.html.twig' with { 
					'url': path('revision.revert', {'id': revisionId}), 
					'label': 'Revert revision', 
					'icon': 'undo' }%}
			{% endif %}		
		{% endif %}
			
		{% if environments|length %}
			{% include 'elements/post-button.html.twig' with { 
				'url': path('revision.reindex', {'revisionId': revisionId}), 
				'label': 'Re-index', 
				'icon': 'recycle'}%}
		{% endif %}
		
		  {% if is_granted('ROLE_PUBLISHER') and hasEnv  %}
		  	<div class="btn-group">
			  <button type="button" class="btn btn-sm btn-danger dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
			    	<span class="glyphicon glyphicon-open"></span>&nbsp;
					Publish to
					<span class="caret"></span>
			  </button>
			   <ul class="dropdown-menu">
			   		{% for env in availableEnv %}
						{% if env not in environments %}
				   			<li>
				   				<a href="{{ path('revision.publish_to', {'revisionId': revisionId, 'envId': env.id}) }}">{{ env.name|humanize }}</a>
				   			</li>
				   		{% endif %}
			   		{% endfor %}
			   </ul>
			</div>
		  {% endif %}
		
		  {% if is_granted('ROLE_PUBLISHER') and ((environments|length > 0 and not current) or (environments|length > 1 and current)) %}
		  	<div class="btn-group">
			  <button type="button" class="btn btn-sm btn-danger dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
			    	<span class="fa fa-close"></span>&nbsp;
					Unpublish from
					<span class="caret"></span>
			  </button>
			   <ul class="dropdown-menu">
			   		{% for env in availableEnv %}
						{% if env in environments %}
				   			<li>
				   				<a href="{{ path('revision.unpublish', {'revisionId': revisionId, 'envId': env.id}) }}">{{ env.name|humanize }}</a>
				   			</li>
				   		{% endif %}
			   		{% endfor %}
			   </ul>
			</div>
		  {% endif %}
		  
	{% endif %}
</div>